<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Tracker v3.0.2</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gray: { 850: '#1f2937', 900: '#111827', 950: '#0b0f19' },
                        primary: { 400: '#2dd4bf', 500: '#14b8a6', 600: '#0d9488' }
                    }
                }
            }
        }
    </script>
    
    <script>
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Base Styles */
        body { -webkit-tap-highlight-color: transparent; }
        input, select, textarea { -webkit-appearance: none; -moz-appearance: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; } 
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-in-out; } 
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .animate-slide-up { animation: slideUp 0.3s ease-out; } 
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        .pop-in { animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        
        /* Components */
        .spinner { border: 2px solid rgba(156, 163, 175, 0.3); border-top-color: #2dd4bf; border-radius: 50%; width: 20px; height: 20px; animation: spin 0.8s linear infinite; } 
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .form-checkbox { appearance: none; background-color: #f3f4f6; border: 1px solid #d1d5db; display: inline-block; position: relative; }
        .dark .form-checkbox { background-color: #1f2937; border-color: #374151; }
        
        .form-checkbox:checked { background-color: #2dd4bf; border-color: #2dd4bf; }
        .form-checkbox:checked:after { content: '‚úî'; position: absolute; top: -2px; left: 1px; font-size: 10px; color: #000; }
        
        /* Toast Notification */
        .toast { position: fixed; bottom: 20px; right: 20px; z-index: 9999; transform: translateX(400px); transition: transform 0.3s ease-out; }
        .toast.show { transform: translateX(0); }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 dark:bg-gray-950 dark:text-gray-200 font-sans pb-20 transition-colors duration-300">

    <input type="file" id="csv-file-input" accept=".csv" class="hidden">

    <div id="toast-container"></div>

    <div id="auth-screen" class="fixed inset-0 z-50 bg-white dark:bg-gray-950 flex flex-col items-center justify-center p-6 fade-in transition-colors duration-300">
        <div class="w-full max-w-sm space-y-8">
            <div class="text-center space-y-2">
                <i class="fa-solid fa-rocket text-primary-500 text-5xl mb-4"></i>
                <h1 class="text-3xl font-bold text-gray-900 dark:text-white tracking-tight">Crypto Tracker</h1>
                <p class="text-gray-500 text-sm">Prisijunkite, kad matytumƒóte savo portfelƒØ</p>
            </div>
            
            <div id="passkey-section" class="hidden">
                <button type="button" id="btn-passkey-login" class="w-full bg-gradient-to-r from-primary-600 to-primary-500 hover:from-primary-500 hover:to-primary-400 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-3">
                    <i class="fa-solid fa-fingerprint text-2xl"></i>
                    <span>Prisijungti su Face ID / Passkey</span>
                </button>
                
                <div class="relative my-6">
                    <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300 dark:border-gray-800"></div></div>
                    <div class="relative flex justify-center text-xs"><span class="bg-white dark:bg-gray-950 px-2 text-gray-500">arba</span></div>
                </div>
            </div>
            
            <div class="bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 p-6 rounded-2xl shadow-xl dark:shadow-2xl space-y-4 transition-colors duration-300">
                <input type="email" id="auth-email" placeholder="vardas@pavyzdys.lt" autocomplete="email" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white rounded-xl p-3 outline-none focus:border-primary-500 transition-colors">
                <input type="password" id="auth-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white rounded-xl p-3 outline-none focus:border-primary-500 transition-colors">
                <div class="pt-2 space-y-3">
                    <button type="button" id="btn-login" class="w-full bg-primary-600 hover:bg-primary-500 text-white font-bold py-3 rounded-xl shadow-lg transition-all active:scale-95">Prisijungti</button>
                    <button type="button" id="btn-signup" class="w-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 font-bold py-3 rounded-xl border border-gray-200 dark:border-gray-700 transition-all active:scale-95">Registruotis</button>
                </div>
            </div>
            <p id="auth-error" class="text-red-500 dark:text-red-400 text-xs text-center hidden"></p>
        </div>
    </div>

    <div id="app-content" class="hidden">
        
        <header class="fixed top-0 w-full bg-white/95 dark:bg-gray-900/95 backdrop-blur border-b border-gray-200 dark:border-gray-800 z-40 transition-colors duration-300">
            <div class="max-w-md mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <i class="fa-solid fa-chart-pie text-primary-500 dark:text-primary-400 text-lg"></i>
                    <h1 class="font-bold text-base tracking-wide text-gray-900 dark:text-gray-100">Portfelis</h1>
                </div>
                <div class="flex items-center gap-4">
                    <div class="text-right">
                        <p class="text-[10px] text-gray-500 uppercase font-semibold">Bendra vertƒó</p>
                        <p id="header-total-value" class="text-lg font-bold text-gray-900 dark:text-white tracking-tight">$0.00</p>
                        <p class="text-[9px] text-gray-600 mt-0.5">Investuota: <span id="total-invested" class="text-primary-600 dark:text-primary-400 font-bold">$0.00</span></p>
                    </div>
                    <button type="button" id="btn-settings" class="text-gray-500 hover:text-primary-500 transition-colors" title="Nustatymai" aria-label="Open settings">
                        <i class="fa-solid fa-gear text-lg" aria-hidden="true"></i>
                    </button>
                    <button type="button" id="btn-logout" class="text-gray-500 hover:text-red-500 dark:hover:text-red-400 transition-colors" title="Atsijungti" aria-label="Log out">
                        <i class="fa-solid fa-right-from-bracket text-lg" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </header>

        <main class="max-w-md mx-auto px-4 pt-20 space-y-5 min-h-screen">
            
            <section class="grid grid-cols-1 gap-4">
                <div class="bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-4 shadow-lg relative overflow-hidden transition-colors duration-300">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <p class="text-[10px] text-gray-500 uppercase font-bold tracking-wider">Visas Pelnas/Nuostolis</p>
                            <div class="flex items-baseline gap-2 mt-1">
                                <h2 id="total-pnl" class="text-2xl font-bold text-gray-900 dark:text-white">$0.00</h2>
                                <span id="total-pnl-percent" class="text-xs font-bold px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400">0.00%</span>
                            </div>
                            <div id="pnl-24h-change" class="text-[10px] text-gray-500 mt-1 hidden">
                                24h: <span id="pnl-24h-value" class="font-bold">+$0.00</span>
                            </div>
                        </div>
                        <div id="tf-indicator" class="bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded text-[10px] font-bold text-gray-500 transition-colors">ALL</div>
                    </div>
                    
                    <div class="h-48 w-full mb-4"><canvas id="pnlChart"></canvas></div>

                    <div class="flex justify-between items-center px-1 bg-gray-100 dark:bg-gray-800/50 p-1 rounded-xl gap-0.5">
                        <button type="button" onclick="window.changePnLTimeframe('24H')" class="tf-btn flex-1 text-[10px] font-bold text-gray-400 hover:text-gray-900 dark:hover:text-white py-1 transition-colors rounded" data-tf="24H">24H</button>
                        <button type="button" onclick="window.changePnLTimeframe('1W')" class="tf-btn flex-1 text-[10px] font-bold text-gray-400 hover:text-gray-900 dark:hover:text-white py-1 transition-colors rounded" data-tf="1W">1W</button>
                        <button type="button" onclick="window.changePnLTimeframe('1M')" class="tf-btn flex-1 text-[10px] font-bold text-gray-400 hover:text-gray-900 dark:hover:text-white py-1 transition-colors rounded" data-tf="1M">1M</button>
                        <button type="button" onclick="window.changePnLTimeframe('3M')" class="tf-btn flex-1 text-[10px] font-bold text-gray-400 hover:text-gray-900 dark:hover:text-white py-1 transition-colors rounded" data-tf="3M">3M</button>
                        <button type="button" onclick="window.changePnLTimeframe('6M')" class="tf-btn flex-1 text-[10px] font-bold text-gray-400 hover:text-gray-900 dark:hover:text-white py-1 transition-colors rounded" data-tf="6M">6M</button>
                        <button type="button" onclick="window.changePnLTimeframe('1Y')" class="tf-btn flex-1 text-[10px] font-bold text-gray-400 hover:text-gray-900 dark:hover:text-white py-1 transition-colors rounded" data-tf="1Y">1Y</button>
                        <button type="button" onclick="window.changePnLTimeframe('5Y')" class="tf-btn flex-1 text-[10px] font-bold text-gray-400 hover:text-gray-900 dark:hover:text-white py-1 transition-colors rounded" data-tf="5Y">5Y</button>
                        <button type="button" onclick="window.changePnLTimeframe('ALL')" class="tf-btn flex-1 text-[10px] font-bold text-white bg-gray-800 dark:bg-gray-600 shadow-sm py-1 transition-colors rounded" data-tf="ALL">ALL</button>
                    </div>
                </div>
            </section>

            <section>
                <h3 class="text-gray-500 text-xs uppercase font-bold ml-1 mb-2">Turto Paskirstymas</h3>
                <div class="bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-4 shadow-lg transition-colors duration-300">
                    <div style="max-height: 250px; position: relative;"><canvas id="allocationChart"></canvas></div>
                </div>
            </section>

            <section>
                <h3 class="text-gray-500 text-xs uppercase font-bold ml-1 mb-2">Turimas Turtas</h3>
                <div id="coin-cards-container" class="grid grid-cols-1 gap-3"></div>
            </section>

            <section id="goals-section" class="hidden">
                <h3 class="text-gray-500 text-xs uppercase font-bold ml-1 mb-2">Tiksl≈≥ Progresas</h3>
                <div id="goals-container" class="space-y-3"></div>
            </section>

            <section class="grid grid-cols-2 gap-3">
                <button type="button" onclick="document.getElementById('add-modal').classList.remove('hidden')" class="bg-primary-600 hover:bg-primary-500 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-primary-900/30 flex items-center justify-center gap-2 active:scale-95 transition-transform">
                    <i class="fa-solid fa-plus"></i> Pridƒóti
                </button>
                <button type="button" onclick="document.getElementById('csv-file-input').click()" class="bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-white font-bold py-3.5 rounded-xl border border-gray-200 dark:border-gray-700 flex items-center justify-center gap-2 active:scale-95 transition-colors">
                    <i class="fa-solid fa-file-import"></i> CSV Importas
                </button>
            </section>

            <section>
                <div class="flex justify-between items-end mb-2 px-1 flex-wrap gap-2">
                    <div class="flex items-center gap-3">
                        <h3 class="text-gray-500 text-xs uppercase font-bold">Istorija</h3>
                        <label class="flex items-center gap-1.5 text-[10px] text-gray-400 cursor-pointer select-none hover:text-gray-800 dark:hover:text-white transition-colors bg-white dark:bg-gray-900 px-2 py-1 rounded border border-gray-200 dark:border-gray-800">
                            <input type="checkbox" id="select-all-tx" class="form-checkbox h-3 w-3 text-primary-500 rounded border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-800 focus:ring-0 cursor-pointer">
                            <span>ViskƒÖ</span>
                        </label>
                    </div>
                    <div class="flex gap-2">
                        <button type="button" id="btn-delete-selected" class="hidden text-[10px] text-red-500 hover:text-red-600 items-center gap-1 transition-colors bg-red-100 dark:bg-red-900/20 px-2 py-1 rounded border border-red-200 dark:border-red-900/30">
                            <i class="fa-solid fa-trash"></i> Trinti (<span id="selected-count">0</span>)
                        </button>
                        <button type="button" id="btn-export-csv" class="text-[10px] text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-white flex items-center gap-1 transition-colors">
                            <i class="fa-solid fa-file-csv"></i> CSV Eksportas
                        </button>
                    </div>
                </div>
                <div id="journal-accordion" class="space-y-3">
                    <div class="px-4 py-8 text-center text-xs text-gray-600"><div class="spinner mx-auto mb-2"></div>Kraunama...</div>
                </div>
            </section>

            <section class="text-center pt-4 border-t border-gray-200 dark:border-gray-800 mt-6">
                <p class="text-[10px] text-gray-500 mb-2 uppercase font-bold">Valdymas</p>
                <div class="flex justify-center gap-4">
                    <button type="button" onclick="document.getElementById('new-coin-modal').classList.remove('hidden')" class="text-xs text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-white underline decoration-gray-300 dark:decoration-gray-700 underline-offset-4 transition-colors">Pridƒóti MonetƒÖ</button>
                    <button type="button" onclick="document.getElementById('delete-coin-modal').classList.remove('hidden')" class="text-xs text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-white underline decoration-gray-300 dark:decoration-gray-700 underline-offset-4 transition-colors">I≈°trinti MonetƒÖ</button>
                </div>
            </section>

            <footer class="mt-10 py-8 text-center space-y-1 opacity-70">
                <p class="text-[11px] text-gray-500">Sukurta su <i class="fa-solid fa-heart text-red-500 mx-0.5 animate-pulse"></i> ir DI pagalba</p>
                <p class="text-[10px] text-gray-600">&copy; <span id="auto-year"></span> LTV Media PRO. Visos teisƒós saugomos.</p>
                <p class="text-[9px] font-mono text-gray-700 pt-1">Versija <span id="app-version">Kraunama...</span></p>
            </footer>
        </main>
    </div>

    <div id="add-modal" class="hidden fixed inset-0 bg-black/50 dark:bg-black/80 z-50 flex items-end sm:items-center justify-center backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-900 w-full sm:max-w-md sm:rounded-2xl rounded-t-2xl border-t sm:border border-gray-200 dark:border-gray-800 p-5 space-y-5 animate-slide-up sm:animate-none max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center text-gray-900 dark:text-white">
                <h3 class="font-bold text-lg" id="modal-title">Nauja Transakcija</h3>
                <button type="button" onclick="document.getElementById('add-modal').classList.add('hidden')" aria-label="Close modal" class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800 text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors"><i class="fa-solid fa-xmark" aria-hidden="true"></i></button>
            </div>
            <form id="add-tx-form" class="space-y-4">
                <input type="hidden" id="tx-id">
                <div class="grid grid-cols-2 gap-3">
                    <select id="tx-type" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 outline-none font-bold">
                        <option value="Buy">Buy üü¢</option>
                        <option value="Sell">Sell üî¥</option>
                    </select>
                    <div class="relative">
                        <select id="tx-coin" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 outline-none appearance-none font-bold"></select>
                        <i class="fa-solid fa-chevron-down absolute right-3 top-3.5 text-xs text-gray-500 pointer-events-none"></i>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="relative">
                        <label class="absolute -top-2 left-2 px-1 bg-white dark:bg-gray-900 text-[9px] text-gray-500 font-bold uppercase">Data</label>
                        <input type="date" id="tx-date-input" required class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 outline-none focus:border-primary-500 transition-colors">
                    </div>
                    <div class="relative">
                        <label class="absolute -top-2 left-2 px-1 bg-white dark:bg-gray-900 text-[9px] text-gray-500 font-bold uppercase">Laikas</label>
                        <input type="time" id="tx-time-input" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 outline-none focus:border-primary-500 transition-colors">
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                     <div class="relative">
                        <select id="tx-exchange" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 outline-none appearance-none font-bold">
                            <option value="">Bir≈æa...</option>
                            <option value="Binance">Binance</option>
                            <option value="Bybit">Bybit</option>
                            <option value="Coinbase">Coinbase</option>
                            <option value="Crypto.com">Crypto.com</option>
                            <option value="Kraken">Kraken</option>
                            <option value="KuCoin">KuCoin</option>
                            <option value="MEXC">MEXC</option>
                            <option value="Nexo">Nexo</option>
                            <option value="Strike">Strike (BTC)</option>
                            <option value="Jupiter Wallet">Jupiter Wallet</option>
                            <option value="Phantom Wallet">Phantom Wallet</option>
                            <option value="Rabby Wallet">Rabby Wallet</option>
                            <option value="Solflare">Solflare</option>
                            <option value="StepN Wallet">StepN Wallet</option>
                            <option value="Kita / DeFi">Kita / DeFi</option>
                        </select>
                        <i class="fa-solid fa-chevron-down absolute right-3 top-3.5 text-xs text-gray-500 pointer-events-none"></i>
                    </div>
                    <div class="relative">
                        <select id="tx-method" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 outline-none appearance-none">
                            <option value="Market Buy">Market Buy</option>
                            <option value="Limit Buy">Limit Buy</option>
                            <option value="Instant Buy">Instant Buy</option>
                            <option value="Recurring Buy">Recurring Buy</option>
                            <option value="Swap">Swap / DeFi</option>
                            <option value="Transfer">Transfer</option>
                            <option value="Staking Reward">Staking Reward</option>
                            <option value="Gift/Airdrop">Gift / Airdrop</option>
                        </select>
                        <i class="fa-solid fa-chevron-down absolute right-3 top-3.5 text-xs text-gray-500 pointer-events-none"></i>
                    </div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-800/50 p-3 rounded-xl border border-gray-200 dark:border-gray-700/50 space-y-3">
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-[10px] text-gray-500 uppercase font-bold ml-1">Kiekis</label>
                            <input type="number" id="tx-amount" step="any" placeholder="0.00" inputmode="decimal" required class="w-full bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white rounded-lg p-2 outline-none focus:border-primary-500 transition-colors">
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-500 uppercase font-bold ml-1 flex justify-between">
                                Kaina ($) <span id="btn-fetch-price" class="text-primary-600 dark:text-primary-400 cursor-pointer hover:text-primary-800 dark:hover:text-white transition-colors">GAUTI KAINƒÑ</span>
                            </label>
                            <input type="number" id="tx-price" step="any" placeholder="0.00" inputmode="decimal" required class="w-full bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white rounded-lg p-2 outline-none focus:border-primary-500 transition-colors">
                        </div>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-500 uppercase font-bold ml-1">Viso ($)</label>
                        <input type="number" id="tx-total" step="any" placeholder="0.00" inputmode="decimal" required class="w-full bg-white dark:bg-gray-900 border border-primary-500/50 text-gray-900 dark:text-white font-bold rounded-lg p-2 outline-none focus:border-primary-500 transition-colors">
                    </div>
                </div>
                <div>
                    <label class="text-[10px] text-gray-500 uppercase font-bold ml-1">Pastabos</label>
                    <textarea id="tx-notes" rows="2" placeholder="Pvz: Pirkau per rytinƒØ dip'ƒÖ..." class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 mt-1 outline-none resize-none focus:border-primary-500 transition-colors"></textarea>
                </div>
                <button type="submit" id="btn-save" class="w-full bg-primary-600 hover:bg-primary-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95">I≈°saugoti</button>
            </form>
        </div>
    </div>

    <div id="settings-modal" class="hidden fixed inset-0 bg-black/50 dark:bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-gray-800 p-6 space-y-5 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center">
                <h3 class="font-bold text-gray-900 dark:text-white text-xl">Nustatymai</h3>
                <button type="button" onclick="document.getElementById('settings-modal').classList.add('hidden')" aria-label="Close settings" class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800 text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors"><i class="fa-solid fa-xmark" aria-hidden="true"></i></button>
            </div>
            
            <div id="passkey-settings" class="hidden">
                <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-4 space-y-3">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-fingerprint text-primary-500 text-2xl"></i>
                            <div>
                                <p class="text-sm font-bold text-gray-900 dark:text-white">Face ID / Touch ID</p>
                                <p class="text-xs text-gray-500">Greitas prisijungimas</p>
                            </div>
                        </div>
                        <div id="passkey-status" class="text-xs text-gray-500">Tikrinama...</div>
                    </div>
                    <button type="button" id="btn-setup-passkey" class="hidden w-full bg-primary-600 hover:bg-primary-500 text-white text-sm font-bold py-2 rounded-lg transition-colors">ƒÆjungti Passkey</button>
                    <button type="button" id="btn-remove-passkey" class="hidden w-full bg-red-600 hover:bg-red-500 text-white text-sm font-bold py-2 rounded-lg transition-colors">Pa≈°alinti Passkey</button>
                </div>
            </div>

            <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-circle-half-stroke text-primary-500 text-xl"></i>
                        <div>
                            <p class="text-sm font-bold text-gray-900 dark:text-white">I≈°vaizda</p>
                            <p class="text-xs text-gray-500">Tamsi / ≈†viesi tema</p>
                        </div>
                    </div>
                    <button id="btn-toggle-theme" type="button" class="text-xs bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 px-3 py-1.5 rounded-lg font-bold transition-colors text-gray-700 dark:text-gray-200">
                        Keisti
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="new-coin-modal" class="hidden fixed inset-0 bg-black/50 dark:bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-900 w-full max-w-sm rounded-2xl border border-gray-200 dark:border-gray-800 p-5 space-y-4">
            <h3 class="font-bold text-gray-900 dark:text-white">Pridƒóti MonetƒÖ</h3>
            <input type="text" id="new-coin-symbol" placeholder="Simbolis (pvz. KAS)" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white rounded-lg p-3 text-sm uppercase">
            <input type="text" id="new-coin-id" placeholder="CoinGecko ID (pvz. kaspa)" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white rounded-lg p-3 text-sm">
            <input type="number" id="new-coin-target" placeholder="Tikslas (pvz. 100000)" inputmode="decimal" class="w-full bg-gray-50 dark:bg-gray-800 border border-primary-500/30 text-gray-900 dark:text-white rounded-lg p-3 text-sm focus:border-primary-500">
            <div class="flex gap-2">
                <button type="button" onclick="document.getElementById('new-coin-modal').classList.add('hidden')" class="flex-1 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 py-2 rounded-lg text-sm transition-colors">At≈°aukti</button>
                <button id="btn-save-coin" type="button" class="flex-1 bg-primary-600 hover:bg-primary-500 text-white font-bold py-2 rounded-lg text-sm transition-colors">Pridƒóti</button>
            </div>
        </div>
    </div>

    <div id="delete-coin-modal" class="hidden fixed inset-0 bg-black/50 dark:bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-900 w-full max-w-sm rounded-2xl border border-gray-200 dark:border-gray-800 p-5 space-y-4">
            <h3 class="font-bold text-red-500 dark:text-red-400">I≈°trinti MonetƒÖ</h3>
            <div class="relative">
                <select id="delete-coin-select" class="w-full bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-sm rounded-xl p-3 outline-none appearance-none font-bold uppercase"></select>
                <i class="fa-solid fa-chevron-down absolute right-3 top-3.5 text-xs text-gray-500 pointer-events-none"></i>
            </div>
            <div class="flex gap-2">
                <button type="button" onclick="document.getElementById('delete-coin-modal').classList.add('hidden')" class="flex-1 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 py-2 rounded-lg text-sm transition-colors">At≈°aukti</button>
                <button id="btn-delete-coin" type="button" class="flex-1 bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded-lg text-sm transition-colors">I≈°trinti</button>
            </div>
        </div>
    </div>

    <div id="edit-goal-modal" class="hidden fixed inset-0 bg-black/50 dark:bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-900 w-full max-w-sm rounded-2xl border border-gray-200 dark:border-gray-800 p-5 space-y-4">
            <h3 class="font-bold text-gray-900 dark:text-white">Redaguoti TikslƒÖ</h3>
            <input type="hidden" id="edit-goal-id">
            <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700">
                <p class="text-xs text-gray-500 mb-1">Moneta</p>
                <p id="edit-goal-coin" class="text-lg font-bold text-gray-900 dark:text-white">BTC</p>
            </div>
            <div>
                <label class="text-xs text-gray-500 font-bold uppercase ml-1">Naujas Tikslas</label>
                <input type="number" id="edit-goal-target" placeholder="pvz. 150000" inputmode="decimal" class="w-full bg-gray-50 dark:bg-gray-800 border border-primary-500/30 text-gray-900 dark:text-white rounded-lg p-3 text-sm focus:border-primary-500 mt-1">
            </div>
            <div class="flex gap-2">
                <button type="button" onclick="document.getElementById('edit-goal-modal').classList.add('hidden')" class="flex-1 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 py-2 rounded-lg text-sm transition-colors">At≈°aukti</button>
                <button id="btn-update-goal" type="button" class="flex-1 bg-primary-600 hover:bg-primary-500 text-white font-bold py-2 rounded-lg text-sm transition-colors">Atnaujinti</button>
                <button id="btn-delete-goal" type="button" class="px-3 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm transition-colors">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </div>
        </div>
    </div>

    <div id="celebration-modal" class="hidden fixed inset-0 z-[60] flex items-center justify-center bg-black/90 fade-in">
        <div class="text-center space-y-4 p-6 pop-in">
            <div class="text-6xl animate-bounce">üèÜ</div>
            <h2 class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-primary-400">Sveikiname!</h2>
            <p class="text-xl text-gray-300">J≈´s pasiekƒóte <span id="celebration-coin" class="font-bold text-white"></span> tikslƒÖ!</p>
            <p class="text-sm text-gray-500">J≈´s≈≥ disciplina atsiperka.</p>
            <button type="button" onclick="document.getElementById('celebration-modal').classList.add('hidden')" class="mt-4 bg-primary-600 hover:bg-primary-500 text-white px-8 py-3 rounded-full font-bold shadow-lg transition-transform active:scale-95">Aƒçi≈´! üöÄ</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script type="module" src="js/app.js"></script>
    
    <script>
        document.getElementById('auto-year').textContent = new Date().getFullYear();
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                ['add-modal', 'new-coin-modal', 'delete-coin-modal', 'celebration-modal', 'settings-modal', 'edit-goal-modal'].forEach(id => {
                    const modal = document.getElementById(id);
                    if (modal && !modal.classList.contains('hidden')) modal.classList.add('hidden');
                });
            }
        });
    </script>
</body>
</html>
